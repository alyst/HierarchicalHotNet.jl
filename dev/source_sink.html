<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Source → Sink Flows · HierarchicalHotNet.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="HierarchicalHotNet.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">HierarchicalHotNet.jl</span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li><a class="tocitem" href="network_diffusion.html">Network Diffusion</a></li><li><a class="tocitem" href="scctree.html">SCC Tree</a></li><li class="is-active"><a class="tocitem" href="source_sink.html">Source → Sink Flows</a><ul class="internal"><li><a class="tocitem" href="#network_metrics"><span>Network Metrics</span></a></li></ul></li><li><a class="tocitem" href="stats.html">Statistics</a></li><li><a class="tocitem" href="export.html">Export</a></li><li><a class="tocitem" href="utils.html">Utilities</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="source_sink.html">Source → Sink Flows</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="source_sink.html">Source → Sink Flows</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/alyst/HierarchicalHotNet.jl/blob/master/docs/src/source_sink.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="source_sink"><a class="docs-heading-anchor" href="#source_sink">Source-Sink Analysis</a><a id="source_sink-1"></a><a class="docs-heading-anchor-permalink" href="#source_sink" title="Permalink"></a></h1><p>For any edge weight threshold <em>t</em>, cutting the <a href="scctree.html#scctree"><em>strongly connected components (SCC) tree</em></a> provides the set of SCC of the original directed weighted network. Within each SCC subnetwork, there is a path from any node to any other node along the edges with weights not smaller than <em>t</em>. The original network may still contain the other edges with weights <em>≥t</em>, which can connect one SCC subnetwork to the other, but it is not possible to reenter the same SCC again by traveling along these edges (otherwise by definition there is a bigger SCC). In other words, for each <em>t</em> we have a <em>direct acyclic graph</em> of connections between SCCs.</p><p>This property makes it very convenient to enumerate all paths from one set of nodes (<em>sources</em>) to the other (<em>sinks</em>). It is implemented by the <a href="@ref"><code>HierarchicalHotNet.flowgraph()</code></a> method. One can use it to identify signaling subnetworks that connect one biological data (e.g. interactors of a particular protein) to another (e.g. downstream changes resulting from knock out or overexpressing this protein).</p><p>The output of <a href="@ref"><code>HierarchicalHotNet.flowgraph()</code></a> is the subnetwork that consists of selected SCCs and the edges that connect these SCCs, plus the list of paths within this subnetwork from <em>source</em> to <em>sink</em> nodes. It could be shown that the path lengths tend to be smaller for the diffusion networks based on the real data than the ones based on the reshuffled node weights.</p><h2 id="network_metrics"><a class="docs-heading-anchor" href="#network_metrics">Network Metrics</a><a id="network_metrics-1"></a><a class="docs-heading-anchor-permalink" href="#network_metrics" title="Permalink"></a></h2><p>It&#39;s is important to have a way to check the relevance of <em>HierarchicalHotNet</em> predictions. For example, one can <a href="network_diffusion.html#permweights">randomize the input data</a> and show that, at some edge weight threshold <span>$t_*$</span>, <em>HHotNet</em> predictions based on the real data, <span>$H(\mathcal{D}_{\mathrm{real}}, t_*)$</span>, demnostrate significantly more order than the ones based on randomized data, <span>$H(\mathcal{D}_{\mathrm{perm}}^i, t_*)$</span>, <span>$i=1,2,\ldots,N_{\mathrm{perm}}$</span>. If the &quot;order&quot; could be expressed as some metric <span>$m(H)$</span>, then we can easily define the <span>$p$</span>-value for the hypothesis that <span>$H(\mathcal{D}_{\mathrm{real}}, t)$</span> is significantly more &quot;ordered&quot; than expected by chance:</p><p class="math-container">\[p_m(H(\mathcal{D}_{\mathrm{real}}, t)) = P\big(M_{\mathrm{perm}}(t) \geq m(H(\mathcal{D}_{\mathrm{real}}, t)) \big),\]</p><p>where <span>$M_{\mathrm{perm}}(t)$</span> is a random variable derived from the empirical distribution of <span>$m(H(\mathcal{D}_{\mathrm{perm}}^i, t))$</span>, <span>$i = 1, 2, \ldots, N_{\mathrm{perm}}$</span>. The definition above was given for the case of <span>$m(H)$</span> growing with the increase of <span>$H$</span> &quot;order&quot;. If the metric <span>$m$</span> decreases as the &quot;order&quot; of <span>$H$</span> grows, <span>$P(M \geq m(H))$</span> should be changed to <span>$P(M \leq m(H))$</span>.</p><p>In <a href="https://academic.oup.com/bioinformatics/article/34/17/i972/5093236"><em>M.A. Reyna et al</em> (2018)</a>, the <span>$m_{\max\mathrm{size}}(H)$</span> metric – the size of the maximal strongly connected component – was used, and it was shown that <span>$m_{\max\mathrm{size}}(H(\mathcal{D}_{\mathrm{real}}, t))$</span> is statistically significantly larger than at random for some <span>$t_*$</span>. <a href="@ref">HierarchicalHotNet.treecomp_stats</a> provides <span>$m_{\max\mathrm{size}}(t)$</span> in <code>maxcomponent_size</code> column. It is also possible to use the total size of top <em>N</em> components (<code>topn_components_sizesum</code> column) or the number of non-trivial (larger than single node) SCCs (<code>ncomponents_nontrivial</code> column) for the same purpose.</p><h3 id="sourcesink_metrics"><a class="docs-heading-anchor" href="#sourcesink_metrics">Flow Metrics</a><a id="sourcesink_metrics-1"></a><a class="docs-heading-anchor-permalink" href="#sourcesink_metrics" title="Permalink"></a></h3><p>Metrics like <span>$m_{\max\mathrm{size}}(H)$</span> could be used for the analysis of significantly perturbed subnetworks, but they don&#39;t allow estimating how strong is the relationship between sources and sinks. The source-to-sink flows analysis requires different metrics. The one that shows good results is <em>the average inverse of flow length</em>:</p><p class="math-container">\[L_{\mathrm{avg}}^{-1}(H) = \frac{1}{N_{\mathrm{source}} \cdot N_{\mathrm{sink}}} \sum_{f \in \mathrm{flows}(H)} \frac{1}{N_{\mathrm{SCC}}(f)},\]</p><p>where <span>$N_{\mathrm{source}}$</span> and <span>$N_{\mathrm{sink}}$</span> are the numbers of sources and sinks, respectively (so <span>$N_{\mathrm{source}} \cdot N_{\mathrm{sink}}$</span> is the number of all possible distinct flows), <span>$\mathrm{flows}(H)$</span> are all the source-to-sink flows of <span>$H$</span>, and <span>$N_{\mathrm{SCC}}(f)$</span> is the number of distinct strongly connected components that contain the nodes of the <span>$f$</span> flow. This metric changes from 1 (all sources and sinks in the same stongly connected component) to 0 (no or infinitely long flows). This metric is available as <code>flow_avginvlen</code> column in the <a href="@ref">HierarchicalHotNet.treecomp_stats</a> output.</p><p>The alternative metrics for the flow analysis provided by <a href="@ref">HierarchicalHotNet.treecomp_stats</a> are:</p><ul><li>the average transition probability of the flow (<code>flow_avgweight</code> column):</li></ul><p class="math-container">\[w_{\mathrm{avg. flow}}(H) = \frac{1}{N_{\mathrm{src}} \cdot N_{\mathrm{sink}}} \sum_{f \in \mathrm{flows}(H)} \min \big( w(\mathrm{source}(f), \mathrm{sink}(f)), w_{\max} \big),\]</p><p>where <span>$w(i, j)$</span> is the transition probability from <span>$i$</span>-th to <span>$j$</span>-th node in the random walk with restart. The distribution of <span>$w(i, j)$</span> is essentially non-gaussian, and to limit the strong influence of a few &quot;outliers&quot; on the total <span>$w_{\mathrm{avg. flow}}(H)$</span>, some <span>$w_{\max}$</span> constant is used.</p><ul><li>the average flow transition probability per SCC (<code>flow_avghopweight</code> column):</li></ul><p class="math-container">\[w_{\mathrm{avg. hop}}(H) = \frac{1}{N_{\mathrm{src}} \cdot N_{\mathrm{sink}}} \sum_{f \in \mathrm{flows}(H)} \frac{\min \big( w(\mathrm{source}(f), \mathrm{sink}(f)), w_{\max} \big)}{N_{\mathrm{SCC}}(f)},\]</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>HierarchicalHotNet.flowgraph</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>HierarchicalHotNet.flowgraph!</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="HierarchicalHotNet.nflows" href="#HierarchicalHotNet.nflows"><code>HierarchicalHotNet.nflows</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">nflows(comps::IndicesPartition, adjmtx::AbstractMatrix,
       sources::AbstractVector{Int}, sinks::AbstractVector{Int},
       test::EdgeTest;
       maxweight::Union{Number, Nothing} = nothing,
       used_sources::Union{AbstractVector{Int}, Nothing}=nothing,
       used_sinks::Union{AbstractVector{Int}, Nothing}=nothing) -&gt; NamedTupe</code></pre><p>Calculates statistics from the flows from <em>sources</em> to <em>sinks</em> vertices in the weighted directed graph defined by <em>adjmtx</em> and <em>test</em> and the <em>comps</em> vertex components.</p><p>Returns the <em>NamedTuple</em> with the following fields</p><ul><li><code>nflows</code>: the number of <em>source</em> → <em>sink</em> flows</li><li><code>ncompoflows</code>: the number of unique <em>component(source)</em> → <em>component(sink)</em> pairs for each <em>source</em> → <em>sink</em> flow</li><li><code>flowlen_sum</code>: total length of all flows (flow length = the number of SCCs it crosses)</li><li><code>compflowlen_sum</code>: total length of flows (every unique pairs of source/sink components is counted once)</li><li><code>flowinvlen_sum</code>: the sum of <span>$1/\mathrm{flowlength}$</span></li><li><code>compflowinvlen_sum</code>: the sum of <span>$1/\mathrm{flowlength}$</span> (each unique source/sink component pair is counted once)</li><li><code>compflowlen_max</code>:</li><li><code>floweight_sum</code>:</li><li><code>floweight_sum</code>:</li><li><code>compfloweight_sum</code>:</li><li><code>flowavghopweight_sum</code>:</li><li><code>ncompsources</code>: the number of distinct SCCs that have source nodes</li><li><code>ncompsinks</code>: the number of distinct SCCs that have sink nodes</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>maxweight</code>: if specified, limits the flow weight by <code>maxweight</code></li><li><code>used_sources::AbstractVector{Int}</code>: if specified, acts as an output parameter that contains the  sorted list of sources that have outgoing flows</li><li><code>used_sinks::AbstractVector{Int}</code>: if specified, acts as an output parameter that contains the  sorted list of sinks that have incoming flows</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/HierarchicalHotNet.jl/blob/7d2d27f0cc878ddbebcde5f067ba50e19cddb570/src/flows.jl#L297-L329">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HierarchicalHotNet.traceflows" href="#HierarchicalHotNet.traceflows"><code>HierarchicalHotNet.traceflows</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">traceflows(step_adjmtx::AbstractMatrix, steptest::EdgeTest,
           walk_adjmtx::AbstractMatrix, walktest::EdgeTest;
           kwargs...) -&gt; Dict{Diedge, Partition{Int}}</code></pre><p>Trace the random walk (specified by <em>walk_adjmtx</em> and <em>walktest</em>) steps in the original graph (given by <em>step_adjmtx</em> and <em>steptest</em>).</p><p>See <a href="source_sink.html#HierarchicalHotNet.traceflows!"><code>HierarchicalHotNet.traceflows!</code></a> for the detailed description.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/HierarchicalHotNet.jl/blob/7d2d27f0cc878ddbebcde5f067ba50e19cddb570/src/flows.jl#L538-L547">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HierarchicalHotNet.traceflows!" href="#HierarchicalHotNet.traceflows!"><code>HierarchicalHotNet.traceflows!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">traceflows!(flow2paths::AbstractDict{Diedge, Partition{Int}},
            step_adjmtx::AbstractMatrix,
            steptest::EdgeTest,
            walk_adjmtx::AbstractMatrix,
            walktest::EdgeTest;
            sources::Union{AbstractVector, AbstractSet, Nothing} = nothing,
            sinks::Union{AbstractVector, AbstractSet, Nothing} = nothing,
            maxsteps::Integer=2) -&gt; Dict{Diedge, Partition{Int}}</code></pre><p>Trace the random walk (specified by <em>walk_adjmtx</em> and <em>walktest</em>) steps in the original graph (given by <em>step_adjmtx</em> and <em>steptest</em>).</p><p><strong>Keyword arguments</strong></p><ul><li><code>sources</code> (optional): the indices of vertices to use as path starts. If not specified, all vertices are used as path starts.</li><li><code>sinks</code> (optional): the indices of vertices to use as path ends. If not specified, all vertices are used as path ends.</li><li><code>maxsteps=2</code>: maximal number of steps in a traced path, longer paths are discarded.</li></ul><p>Returns the mapping from the flow diedges to the <a href="utils.html#HierarchicalHotNet.Partition"><code>HierarchicalHotNet.Partition</code></a> object. Each part corresponds to the path, from diedge start to diedge end, in the original network, and the part elements are the indices of the intermedidate vertices along the path (start and end not included).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/HierarchicalHotNet.jl/blob/7d2d27f0cc878ddbebcde5f067ba50e19cddb570/src/flows.jl#L440-L463">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="scctree.html">« SCC Tree</a><a class="docs-footer-nextpage" href="stats.html">Statistics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 25 November 2020 18:17">Wednesday 25 November 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
