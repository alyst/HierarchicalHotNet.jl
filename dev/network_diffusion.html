<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Network Diffusion · HierarchicalHotNet.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="HierarchicalHotNet.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">HierarchicalHotNet.jl</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li class="is-active"><a class="tocitem" href="network_diffusion.html">Network Diffusion</a><ul class="internal"><li><a class="tocitem" href="#netweights"><span>Node and edge weights</span></a></li><li><a class="tocitem" href="#permweights"><span>Node weights permutation</span></a></li></ul></li><li><a class="tocitem" href="scctree.html">SCC Tree</a></li><li><a class="tocitem" href="source_sink.html">Source → Sink Flows</a></li><li><a class="tocitem" href="stats.html">Statistics</a></li><li><a class="tocitem" href="export.html">Export</a></li><li><a class="tocitem" href="utils.html">Utilities</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="network_diffusion.html">Network Diffusion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="network_diffusion.html">Network Diffusion</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/alyst/HierarchicalHotNet.jl/blob/master/docs/src/network_diffusion.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="netdiff"><a class="docs-heading-anchor" href="#netdiff">Network Diffusion</a><a id="netdiff-1"></a><a class="docs-heading-anchor-permalink" href="#netdiff" title="Permalink"></a></h1><p><em>Network diffusion</em> is an efficient way to model signal propagation in molecular networks. While it could not be regarded as an accurate simulation of biological system, <em>network diffusion</em> allows assessing complex molecular networks and revealing various topological structures, such as hubs, communities etc.</p><p>Currently, <em>HierarchicalHotNet.jl</em> package implements <a href="https://en.wikipedia.org/wiki/Random_walk"><em>random walk with restart</em></a> diffusion method. The input weighted graph is processed by <a href="network_diffusion.html#HierarchicalHotNet.stepmatrix"><code>stepmatrix()</code></a> function, which prepares the <em>adjacency matrix</em> for the random walk. The resulting matrix is then submitted to <a href="@ref HierarchicalHotNet.random_walk_with_restart"><code>random_walk_with_restart()</code></a> method that generates the matrix of random walk transition probabilities.</p><p>Alternatively, one can use <a href="network_diffusion.html#HierarchicalHotNet.stabilized_stepmatrix"><code>stabilized_stepmatrix()</code></a> method to weight the edges of the original network according to how frequently their are being utilized during the random walk.</p><h2 id="netweights"><a class="docs-heading-anchor" href="#netweights">Node and edge weights</a><a id="netweights-1"></a><a class="docs-heading-anchor-permalink" href="#netweights" title="Permalink"></a></h2><p>TODO</p><article class="docstring"><header><a class="docstring-binding" id="HierarchicalHotNet.stepmatrix" href="#HierarchicalHotNet.stepmatrix"><code>HierarchicalHotNet.stepmatrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">stepmatrix(g::Union{AbstractSimpleWeightedGraph, AbstractMatrix};
           inedge_weights::Union{AbstractVector, Nothing} = nothing,
           normalize_weights::Bool = true) -&gt; AbstractMatrix</code></pre><p>Construct the step probabilities matrix for the random walk on graph <code>g</code>.</p><p>Returns matrix <span>$S$</span>, where <span>$s_{i,j}$</span> is the probability to travel along the edge <span>$(v_j, v_i) ∈ g$</span>.</p><ul><li><code>inedge_weights::AbstractVector</code>: (optional) an array of factors  for each vertex to scale the weights of incoming edges</li><li><code>normalize_weights=true</code>: normalize the weights of the columns in  the final output, so that it sums to 1</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/HierarchicalHotNet.jl/blob/6783c2e522f07f3cac3a710b88fabd53b2c9eb4d/src/network_diffusion.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HierarchicalHotNet.random_walk_matrix" href="#HierarchicalHotNet.random_walk_matrix"><code>HierarchicalHotNet.random_walk_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">random_walk_matrix(g::AbstractSimpleWeightedGraph,
                   restart_probability::Number=0.1;
                   stepmtx_kwargs...)</code></pre><p>Calculate the stationary distribution of vertex transition probabilities for a random walk with restart on graph <code>g</code>.</p><p>Returns the matrix <span>$W$</span>, where <span>$w_{i, j}$</span> is the <span>$v_j → v_i$</span> transition probability along the edges of the graph <code>g</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/HierarchicalHotNet.jl/blob/6783c2e522f07f3cac3a710b88fabd53b2c9eb4d/src/network_diffusion.jl#L36-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HierarchicalHotNet.similarity_matrix" href="#HierarchicalHotNet.similarity_matrix"><code>HierarchicalHotNet.similarity_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">similarity_matrix(g::AbstractSimpleWeightedGraph,
                  node_weights::AbstractVector;
                  restart_probability::Union{Number, Nothing} = nothing,
                  stepmtx_kwargs...)</code></pre><p>Calculate the matrix of node transition probabilities for the random walk with restart taking into account the node restarting probabilities <code>node_weights</code>.</p><p>Returns the matrix <span>$Ŵ$</span>, where <span>$ŵ_{i, j}$</span> is the probability of <span>$v_j → v_i$</span> transition considering all possible starting vertices of graph <code>g</code>.</p><p><strong>Parameters</strong></p><ul><li><code>node_weights::AbstractVector</code>: vector of node restart probabilities</li><li><code>restart_probability</code>: random walk restart probability</li><li><a href="@ref">HierarchicalHotNet.stepmatrix</a> keyword arguments</li></ul><p><strong>See also</strong></p><p><a href="@ref">HierarchicalHotNet.random<em>walk</em>matrix</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/HierarchicalHotNet.jl/blob/6783c2e522f07f3cac3a710b88fabd53b2c9eb4d/src/network_diffusion.jl#L63-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HierarchicalHotNet.stabilized_stepmatrix" href="#HierarchicalHotNet.stabilized_stepmatrix"><code>HierarchicalHotNet.stabilized_stepmatrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">stabilized_stepmatrix(g::AbstractSimpleWeightedGraph,
                      node_weights::AbstractVector;
                      restart_probability::Union{Number, Nothing} = nothing,
                      stepmtx_kwargs...)</code></pre><p>Calculate the matrix for the node transition probabilities at each iteration of the random walk with restart taking into account the probabilities of visiting the nodes.</p><p>Returns matrix <span>$Ŝ$</span>. If <span>$w$</span> is the node starting probabilities (<code>node_weights</code>), <span>$S$</span> is the step matrix, and <span>$W$</span> is the corresponding transition probabilities matrix for a random walk with restart, then</p><p class="math-container">\[    Ŝ = (1-r) S × \mathrm{diag}(W × w) + r \mathrm{diag}(w).\]</p><p><strong>Parameters</strong></p><ul><li><code>node_weights::AbstractVector</code>: vector of node restart probabilities</li><li><code>restart_probability</code>: random walk restart probability</li><li><code>node_weights_diffused</code>: precalculated node visiting weights for a random walk with restart (in case the random matrix is already calculated before)</li><li><a href="@ref">HierarchicalHotNet.stepmatrix</a> keyword arguments</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/HierarchicalHotNet.jl/blob/6783c2e522f07f3cac3a710b88fabd53b2c9eb4d/src/network_diffusion.jl#L90-L111">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>HierarchicalHotNet.neighborhood_weights</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="permweights"><a class="docs-heading-anchor" href="#permweights">Node weights permutation</a><a id="permweights-1"></a><a class="docs-heading-anchor-permalink" href="#permweights" title="Permalink"></a></h2><p>One way to confirm the relevance of network diffusion-based predictions is to show that the results based on real the data differ significantly from the ones based on randomized data, where no meaningful patterns are expected.</p><p>In the original HierarchicalHotNet paper by <a href="https://academic.oup.com/bioinformatics/article/34/17/i972/5093236"><em>Reina et al (2018)</em></a> it is proposed to group the vertices with similar in- and out-degrees into bins (see <a href="network_diffusion.html#HierarchicalHotNet.vertexbins"><code>vertexbins()</code></a>) and randomly shuffle the weights of the vertices within each bin (see <a href="network_diffusion.html#HierarchicalHotNet.randpermgroups"><code>randpermgroups()</code></a>).</p><p>This scheme would reassign the weights of hub vertices to other hubs, and low-degree vertices – to other low-degree vertices. So, in addition to preserving the overall distribution of node weights, the correlation of node degree and its weight would be kept too. However, such reshuffling should eliminate the correlation of paths between the specific nodes and the node weights along these paths.</p><article class="docstring"><header><a class="docstring-binding" id="HierarchicalHotNet.vertexbins" href="#HierarchicalHotNet.vertexbins"><code>HierarchicalHotNet.vertexbins</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">vertexbins(g::AbstractSimpleWeightedGraph,
           vertices::AbstractArray{Int}=1:nv(g);
           nbins::Integer=10, by::Symbol=:out, method=:tree) -&gt;
    IndicesPartition</code></pre><p>Partition the <code>vertices</code> of the weighted graph <code>g</code> into <code>nbins</code> bins, so that the vertices of the same bin have similar sum of edge weights.</p><p><strong>Keyword arguments</strong></p><ul><li><code>nbins::Integer</code>: the number of vertex bins. Use <em>nbins</em> &amp;ge; 1 for  bigger (<em>nv</em> &amp;ge; 1) networks</li><li><code>by::Symbol</code>: what edges to consider for grouping vertices. The supported options are:<ul><li><code>:out</code> (<em>default</em>, as in the original paper) – use only the outgoing edges</li><li><code>:in</code> – use only the incoming edges</li><li><code>:outXin</code> (<em>recommended</em>) – use all edges, so that the vertices of the same bin have similar sums of both incoming and outgoing edges</li></ul></li><li><code>method::Symbol</code>: the method for binning vertices<ul><li><code>:sort</code> (as in the original paper) – order the vertices by the sum of weights, then split the sorted array into equal bins. This method doesn&#39;t handle the <code>by=:outXin</code> well.</li><li><code>:tree</code> (<em>default</em>) – build the <em>hierarchical tree</em> of vertices based on their sum of weights, then cut the tree to get the requested number of bins.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/HierarchicalHotNet.jl/blob/6783c2e522f07f3cac3a710b88fabd53b2c9eb4d/src/network_permutation.jl#L1-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HierarchicalHotNet.randpermgroups!" href="#HierarchicalHotNet.randpermgroups!"><code>HierarchicalHotNet.randpermgroups!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">randpermgroups!(v::AbstractVector{Int}, groups::AbstractPartition) -&gt; v</code></pre><p>Randomly reshuffle the elements of <code>groups</code> within each group and put the result into <code>v</code>, group by group.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/HierarchicalHotNet.jl/blob/6783c2e522f07f3cac3a710b88fabd53b2c9eb4d/src/network_permutation.jl#L102-L107">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HierarchicalHotNet.randpermgroups" href="#HierarchicalHotNet.randpermgroups"><code>HierarchicalHotNet.randpermgroups</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">randpermgroups(groups::AbstractPartition) -&gt; Vector{Int}</code></pre><p>Randomly reshuffle the elements of <code>groups</code> within each group.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/alyst/HierarchicalHotNet.jl/blob/6783c2e522f07f3cac3a710b88fabd53b2c9eb4d/src/network_permutation.jl#L121-L125">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Introduction</a><a class="docs-footer-nextpage" href="scctree.html">SCC Tree »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Friday 30 July 2021 11:23">Friday 30 July 2021</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
